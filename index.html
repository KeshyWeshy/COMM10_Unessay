<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RATING PENDING</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary: #f05938;
            --secondary: #0f3460;
            --accent: #f07d23;
            --dark: #1a1a2e;
            --darker: #16213e;
            --light: #f5f5f5;
            --white: #ffffff;
        }
        
        body {
            background: linear-gradient(135deg, var(--dark) 0%, var(--darker) 100%);
            color: var(--light);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            width: 100%;
            max-width: 800px;
            background-color: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            position: relative;
        }
        
        .content {
            padding: 30px;
            min-height: 500px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .scene-image {
            width: 100%;
            height: 400px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
        }
        
        .scene-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .story-text {
            font-size: 18px;
            line-height: 1.6;
            margin-bottom: 30px;
            text-align: center;
            min-height: 120px;
            border-left: 3px solid var(--accent);
            padding-left: 15px;
            text-align: left;
            font-style: italic;
        }
        
        .choices {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .choice-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 15px;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            opacity: 0;
            animation: fadeInUp 0.5s ease forwards;
        }
        
        .choice-btn:nth-child(1) { animation-delay: 0.2s; }
        .choice-btn:nth-child(2) { animation-delay: 0.4s; }
        .choice-btn:nth-child(3) { animation-delay: 0.6s; }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .choice-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-2px);
        }
        
        .desk-interface {
            background: var(--darker);
            padding: 30px;
            border-radius: 10px;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.3);
            position: relative;
            min-height: 400px;
        }
        
        .case-carousel {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin-top: 20px;
            position: relative;
            height: 450px;
        }
        
        .carousel-container {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        .folder {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            border-radius: 12px;
            padding: 0;
            text-align: center;
            cursor: pointer;
            border: 2px solid transparent;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
            position: absolute;
            overflow: hidden;
            width: 280px;
            aspect-ratio: 2/3;
            opacity: 0;
            transform: translateX(0) scale(0.8);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }
        
        .folder.active {
            opacity: 1;
            transform: translateX(0) scale(1);
            z-index: 3;
            border-color: var(--accent);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.6);
        }
        
        .folder.left {
            opacity: 0.7;
            transform: translateX(-180px) scale(0.85);
            z-index: 2;
            filter: blur(1px);
            cursor: pointer;
        }
        
        .folder.right {
            opacity: 0.7;
            transform: translateX(180px) scale(0.85);
            z-index: 2;
            filter: blur(1px);
            cursor: pointer;
        }
        
        .folder.hidden-left {
            opacity: 0;
            transform: translateX(-300px) scale(0.7);
            z-index: 1;
        }
        
        .folder.hidden-right {
            opacity: 0;
            transform: translateX(300px) scale(0.7);
            z-index: 1;
        }
        
        .folder-image {
            width: 100%;
            height: 75%;
            object-fit: cover;
            border-bottom: 3px solid var(--accent);
        }
        
        .folder-content {
            padding: 20px;
            height: 25%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .folder h3 {
            margin-bottom: 8px;
            color: var(--accent);
            font-size: 22px;
        }
        
        .folder p {
            font-size: 14px;
            opacity: 0.9;
            line-height: 1.4;
        }
        
        .case-indicators {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .indicator.active {
            background: var(--accent);
            transform: scale(1.3);
        }
        
        .title-screen {
            text-align: center;
            padding: 40px 30px;
            min-height: 500px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            position: relative;
        }
        
        .title-screen::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 1;
        }
        
        .title-screen > * {
            position: relative;
            z-index: 2;
        }
        
        .title-screen h1 {
            font-size: 64px;
            margin-bottom: 20px;
            color: var(--white);
            font-style: italic;
            font-weight: bold;
            animation: titleGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes titleGlow {
            from { text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5); }
            to { text-shadow: 2px 2px 20px var(--accent), 2px 2px 30px var(--accent); }
        }
        
        .title-screen p {
            font-size: 20px;
            margin-bottom: 30px;
            opacity: 0.9;
        }
        
        .intro-screen, .theoretical-screen, .credits-screen, .final-message-screen, .ending-reflection-screen {
            text-align: center;
            padding: 40px 30px;
        }
        
        .intro-screen h2, .theoretical-screen h2, .credits-screen h2, .final-message-screen h2, .ending-reflection-screen h2 {
            font-size: 32px;
            margin-bottom: 20px;
            color: var(--accent);
        }
        
        .intro-screen p, .theoretical-screen p, .credits-screen p, .final-message-screen p, .ending-reflection-screen p {
            font-size: 18px;
            line-height: 1.6;
            margin-bottom: 30px;
        }
        
        .ending-screen {
            text-align: center;
            padding: 30px;
        }
        
        .ending-title {
            font-size: 28px;
            margin-bottom: 20px;
            color: var(--accent);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .ending-description {
            font-size: 18px;
            line-height: 1.6;
            margin-bottom: 30px;
        }
        
        .consequences {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
            border-left: 4px solid var(--primary);
        }
        
        .consequences h3 {
            color: var(--accent);
            margin-bottom: 10px;
        }
        
        .ending-reflection {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
            border-left: 4px solid var(--accent);
        }
        
        .ending-reflection h3 {
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .next-btn, .start-btn, .continue-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 30px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            opacity: 0;
            animation: fadeIn 1s ease 1s forwards;
        }
        
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        .next-btn:hover, .start-btn:hover, .continue-btn:hover {
            background: var(--accent);
            transform: scale(1.05);
        }
        
        .restart-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 30px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            opacity: 0;
            animation: fadeIn 1s ease 1s forwards;
        }
        
        .restart-btn:hover {
            background: var(--accent);
            transform: scale(1.05);
        }
        
        .skip-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            z-index: 100;
        }
        
        .qr-code {
            width: 200px;
            height: 200px;
            margin: 20px auto;
            background-color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 10px;
        }
        
        .qr-code img {
            width: 90%;
            height: 90%;
            object-fit: contain;
        }
        
        /* Mobile-specific styles */
        @media (max-width: 768px) {
            .container {
                border-radius: 10px;
            }
            
            .content {
                padding: 20px;
            }
            
            .scene-image {
                height: 300px;
            }
            
            .story-text {
                font-size: 16px;
                margin-bottom: 20px;
            }
            
            .choice-btn {
                padding: 12px;
                font-size: 15px;
            }
            
            .folder {
                width: 220px;
            }
            
            .folder.left {
                transform: translateX(-140px) scale(0.85);
            }
            
            .folder.right {
                transform: translateX(140px) scale(0.85);
            }
            
            .folder.hidden-left {
                transform: translateX(-220px) scale(0.7);
            }
            
            .folder.hidden-right {
                transform: translateX(220px) scale(0.7);
            }
            
            .title-screen {
                min-height: 400px;
                padding: 30px 20px;
            }
            
            .title-screen h1 {
                font-size: 36px;
            }
            
            .intro-screen h2, .theoretical-screen h2, .credits-screen h2, .final-message-screen h2, .ending-reflection-screen h2 {
                font-size: 28px;
            }
            
            .ending-title {
                font-size: 24px;
            }
            
            .ending-description {
                font-size: 16px;
            }
            
            .qr-code {
                width: 150px;
                height: 150px;
            }
        }
        
        /* Small mobile devices */
        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            .container {
                border-radius: 8px;
            }
            
            .scene-image {
                height: 200px;
            }
            
            .story-text {
                font-size: 15px;
            }
            
            .choice-btn {
                padding: 10px;
                font-size: 14px;
            }
            
            .folder {
                width: 180px;
            }
            
            .folder.left {
                transform: translateX(-110px) scale(0.85);
            }
            
            .folder.right {
                transform: translateX(110px) scale(0.85);
            }
            
            .folder.hidden-left {
                transform: translateX(-180px) scale(0.7);
            }
            
            .folder.hidden-right {
                transform: translateX(180px) scale(0.7);
            }
            
            .title-screen {
                min-height: 350px;
                padding: 20px 15px;
            }
            
            .title-screen h1 {
                font-size: 28px;
            }
            
            .intro-screen h2, .theoretical-screen h2, .credits-screen h2, .final-message-screen h2, .ending-reflection-screen h2 {
                font-size: 24px;
            }
            
            .qr-code {
                width: 120px;
                height: 120px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="content" id="content">
            <!-- Content will be dynamically updated by JavaScript -->
        </div>
    </div>

    <script>
        // Image paths (using local image references)
        const images = {
            titleBackground: "Title.png",
            startingPoint: "SP.png",
            dreamboi: {
                thumbnail: "TN1.png",
                question1: "P1Q1.png",
                question2: "P1Q2.png",
                question3: "P1Q3.png",
                question4: "Q4.png",
                endingA: "P1E1.png",
                endingB: "P1E2.png",
                endingC: "P1E3.png"
            },
            myFatherMyself: {
                thumbnail: "TN2.png",
                question1: "P2Q1.png",
                question2: "P2Q2.png",
                question3: "P2Q3.png",
                endingA: "P2E.png",
                endingB: "P2E.png",
                endingC: "P2E.png"
            },
            dearSatan: {
                thumbnail: "TN3.png",
                question1: "P3Q1.png",
                question2: "P3Q2.png",
                question3: "P3Q3.png",
                endingA: "5.png",
                endingB: "5.png",
                endingC: "6.png"
            },
            qrCode: "Rating Pending Concept Paper.png"
        };

        // Story data structure with all three case files (updated with dialogue tracker content)
        const storyData = {
            paths: {
                dreamboi: {
                    title: "Dreamboi",
                    description: "Case File #001: A trans woman's intimate journey",
                    questions: [
                        {
                            text: "Diwa is a trans woman. She's not just longing for love; she craves desire itself. In the shadows, she listens to an underground anonymous audio porn actor… until she realizes he's more than just a voice. A member whispers, 'Is this even cinema anymore?' The case file's folder is thick with filed complaints. You flip through the screening notes.",
                            image: "dreamboi.question1"
                        },
                        {
                            text: "The Bureaucrat board member sighs. 'There's nothing valuable about this film. It's just pornography.'",
                            image: "dreamboi.question2"
                        },
                        {
                            text: "The Progressive member tilts her head, 'Do you really believe that?'",
                            image: "dreamboi.question3"
                        },
                        {
                            text: "A 'careful' moment of deliberation passes. How would you rate this film?",
                            image: "dreamboi.question4"
                        }
                    ],
                    choices: [
                        [
                            { text: "This is too explicit.", value: "A" },
                            { text: "This is honest portrayal. Erotic, but human.", value: "B" },
                            { text: "I don't know enough to have an opinion, let's just follow protocol.", value: "C" }
                        ],
                        [
                            { text: "There's a difference between intimacy and provocation. This is a danger to the public and should be banned.", value: "A" },
                            { text: "You strongly object, 'It's not pornography. It's perspective. Trans desire is as valid as heterosexual desire.'", value: "B" },
                            { text: "You say nothing. You check the handbook.", value: "C" }
                        ],
                        [
                            { text: "Think about it and take a look at the other entries. Most of them are as explicit as this one, just heterosexual. Is this really where we're drawing the line?", value: "A" },
                            { text: "Silence. A cough from someone else. You pause and think. Representation matters after all, but should this film be allowed for public viewing?", value: "B" },
                            { text: "You think for a moment. Deep inside, you know that these stories are not given enough representation. I should be careful.", value: "C" }
                        ],
                        [
                            { text: "Vote to X", value: "A" },
                            { text: "Vote to R-18", value: "B" },
                            { text: "Ask for 'revisions' from Filmmaker", value: "C" }
                        ]
                    ],
                    endings: {
                        A: {
                            title: "BANNED",
                            description: "The stamp hits the paper: X. Banned. The director is notified through a carefully worded email.",
                            consequences: "Conservative page: 'PROTECT OUR YOUTH'. Film Twitter: 'So heterosexual sex is fine but not trans intimacy?' The news goes viral and the film community cries out in protest. The decision had to be appealed twice. Due to extreme backlash, it is re-rated to R-18. The film survives, but only in late night viewings, in select cinemas, for people who already agree with you. Visibility is allowed, but strategically limited. This is not erasure. Just controlled exposure.",
                            reflection: "Even when the board gives in to the public (R-18), it does so on its terms. Filmmakers and producers are burdened with material losses and risk invisibility. This maintains hegemony, because power defines how desire is visible.",
                            image: "dreamboi.endingA"
                        },
                        B: {
                            title: "RELEASED",
                            description: "The Bureaucrat shakes his head at the outcome. The vote is 3-1. The movie is stamped for R-18 release.",
                            consequences: "The film survives, but only in late night viewings, in select cinemas, for people who already agree with you. Visibility is allowed, but strategically limited. This is not erasure. Just controlled exposure.",
                            reflection: "Even when the board votes to release the film (R-18), it does so on its own terms by limiting access. This maintains hegemony, because power defines how desire is visible.",
                            image: "dreamboi.endingB"
                        },
                        C: {
                            title: "REVISED",
                            description: "The board acknowledges the artistic ambition of Dreamboi. However, some elements will lead toward ideological confusion. In the spirit of creative compromise, the film may be screened under the following conditions: (1) Fade-to-black on all trans intimacy, and (2) One line where the character affirms 'traditional Filipino values'",
                            consequences: "You granted visibility, but with a leash. The system didn't break; it just policed itself more gently. You did not fully liberate Diwa. But you did let her be seen.",
                            reflection: "Even when the board gives in (R-18), it does so on its terms — trimming fantasy, adding moral commentary, limiting access. This maintains hegemony, because power defines how desire is visible.",
                            image: "dreamboi.endingC"
                        }
                    }
                },
                myFatherMyself: {
                    title: "My Father, Myself",
                    description: "Case File #002: A complex story of love and trauma",
                    questions: [
                        {
                            text: "A disturbing incestuous narrative where a closeted gay man adopts his dead ex-lover's son, and complexly falls in love with him. Sexual abuse. Trauma. Queerness coded as decay. Yet somehow... 'A cautionary tale,' one member says.",
                            image: "myFatherMyself.question1"
                        },
                        {
                            text: "The Conservative board member delights, 'This is the kind of representation we need.'",
                            image: "myFatherMyself.question2"
                        },
                        {
                            text: "The Bureaucrat taps his temple, 'Bad publicity is still publicity. Wouldn't it be better to ignite discourse?'",
                            image: "myFatherMyself.question3"
                        },
                        {
                            text: "A 'careful' moment of deliberation passes. How would you rate this film?",
                            image: "dreamboi.question4"
                        }
                    ],
                    choices: [
                        [
                            { text: "It's probably a real story so it's meant to warn and reflect.", value: "A" },
                            { text: "This is very exploitative and reinforces harmful stereotypes.", value: "B" },
                            { text: "We are just neutral arbiters.", value: "C" }
                        ],
                        [
                            { text: "Let them see the consequences. People need to see this as it's honest, not all gay portrayals should be positive as that is unrealistic.", value: "A" },
                            { text: "You strongly object, 'This portrays queerness as moral collapse. They're using queer pain as a spectacle.'", value: "B" },
                            { text: "You choose the safety of procedure. The most political choice disguised as none.", value: "C" }
                        ],
                        [
                            { text: "He might be right. Portraying sinful behavior allows people to reflect. But... what good does this do? Maybe I should reconsider.", value: "A" },
                            { text: "Not when they are already marginalized, this is just dehumanizing.", value: "B" },
                            { text: "You think for a moment. There's something off about this film. I should be careful.", value: "C" }
                        ],
                        [
                            { text: "Vote to R-18", value: "A" },
                            { text: "Vote to X", value: "B" },
                            { text: "Vote to R-18", value: "C" }
                        ]
                    ],
                    endings: {
                        A: {
                            title: "RESTRICTED RELEASE",
                            description: "The film gets R-18 release. They justify: the film is mature, intense, not for the young. Some see this as truth-telling; others, as a sensational exhibition.",
                            consequences: "Conservative groups would still consider the film disturbing, but turn a blind eye since it is restricted anyways. The misrepresentation satisfies their beliefs. Progressive communities speak out but goes unheard. Status quo is maintained.",
                            reflection: "This is an example of cultural legitimation via regulation: marginal stories are allowed, but only when they reinforce dominant moral structures.",
                            image: "myFatherMyself.endingA"
                        },
                        B: {
                            title: "OUTVOTED",
                            description: "You vote to ban it, but you are outvoted by the others. The film gets R-18 release. They justify: the film is mature, intense, not for the young. Some see this as truth-telling; others, as a sensational exhibition.",
                            consequences: "Conservative groups would still consider the film disturbing, but turn a blind eye since it is restricted anyways. The misrepresentation satisfies their beliefs. Progressive communities speak out but goes unheard. Status quo is maintained.",
                            reflection: "This is an example of cultural legitimation via regulation: marginal stories are allowed, but only when they reinforce dominant moral structures.",
                            image: "myFatherMyself.endingB"
                        },
                        C: {
                            title: "PROCEDURAL RELEASE",
                            description: "The film gets R-18 release. They justify: the film is mature, intense, not for the young. Some see this as truth-telling; others, as a sensational exhibition.",
                            consequences: "Conservative groups would still consider the film disturbing, but turn a blind eye since it is restricted anyways. The misrepresentation satisfies their beliefs. Progressive communities speak out but goes unheard. Status quo is maintained.",
                            reflection: "This is an example of cultural legitimation via regulation: marginal stories are allowed, but only when they reinforce dominant moral structures.",
                            image: "myFatherMyself.endingC"
                        }
                    }
                },
                dearSatan: {
                    title: "Dear Satan",
                    description: "Case File #003: A controversial Christmas story",
                    questions: [
                        {
                            text: "A 'Christmas' film like no other. A little girl named Chichi writes a letter to Santa, but she misspells his name, and it lands in Satan's mailbox. Satan shows up, not to ruin things, but to change. To give gifts. To be... kind. A story of redemption. Letters of complaints make the case file bulky. Somewhere, someone is very offended.",
                            image: "dearSatan.question1"
                        },
                        {
                            text: "The Progressive member cries out, 'Isn't faith about transformation? Why can't evil be invited to reform?'",
                            image: "dearSatan.question2"
                        },
                        {
                            text: "The Conservative slams the table, 'Think about what precedent this will set for future films. Do you really want to encourage this?'",
                            image: "dearSatan.question3"
                        },
                        {
                            text: "A 'careful' moment of deliberation passes. How would you rate this film?",
                            image: "dreamboi.question4"
                        }
                    ],
                    choices: [
                        [
                            { text: "This is blasphemy!", value: "A" },
                            { text: "Redemption stories are interesting.", value: "B" },
                            { text: "Let's keep following procedure and evaluate the content.", value: "C" }
                        ],
                        [
                            { text: "Satan? Good? That's not how religion works. We can't portray evil as redeemable.", value: "A" },
                            { text: "That's actually a compelling plot, faith transforming darkness. Maybe we should let the audience decide how they would interpret this.", value: "B" },
                            { text: "Let's refer to MTRCB guidelines.", value: "C" }
                        ],
                        [
                            { text: "You take a moment to think about it, but no, there's no point in portraying Satan as redeemable... unless?", value: "A" },
                            { text: "Perhaps he has a point, but does it have to be banned? This is not an uncommon trope after all. The series Lucifer is famous for a reason after all.", value: "B" },
                            { text: "You think for a moment. Isn't the point of art to disturb the comfortable and comfort the disturbed? I should be careful.", value: "C" }
                        ],
                        [
                            { text: "Vote to X", value: "A" },
                            { text: "Vote to R-18", value: "B" },
                            { text: "Ask for 'Revisions' from Filmmaker", value: "C" }
                        ]
                    ],
                    endings: {
                        A: {
                            title: "BANNED",
                            description: "The board slams the stamp. X. Dear Satan is officially banned from theaters. The MTRCB Chairwoman states: redemption of Satan is an 'attack on Christian belief.'",
                            consequences: "Church groups: 'Satan will never be good.' Film Twitter: 'What's scarier: the devil or the censors?' Producer note: 'We won't appeal; we'll stream instead.'",
                            reflection: "The MTRCB, like an Ideological State Apparatus, enforces a particular theology — it does not just enforce 'morality.'",
                            image: "dearSatan.endingA"
                        },
                        B: {
                            title: "OUTVOTED",
                            description: "You vote to rate it R-18, but you are outvoted by the others. The board slams the stamp. X. Dear Satan is officially banned from theaters. The MTRCB Chairwoman states: redemption of Satan is an 'attack on Christian belief.'",
                            consequences: "Church groups: 'Satan will never be good.' Film Twitter: 'What's scarier: the devil or the censors?' Producer note: 'We won't appeal; we'll stream instead.'",
                            reflection: "The MTRCB, like an Ideological State Apparatus, enforces a particular theology — it does not just enforce 'morality.'",
                            image: "dearSatan.endingB"
                        },
                        C: {
                            title: "REVISED RELEASE",
                            description: "The board reluctantly gives a restricted rating but demands 'contextual framing.' They require: A preface explaining the film is fictional. A 'moral afterword' text at the end about virtue and faith.",
                            consequences: "Faith-based critics: 'Bold, but dangerous.' Art critics: 'Beautifully subversive.' MTRCB press: 'We defended belief—and let creativity breathe.'",
                            reflection: "Congratulations! You let redemption into power, but only because power insisted on rewriting the terms.",
                            image: "dearSatan.endingC"
                        }
                    }
                }
            }
        };

        // Game state
        let gameState = {
            currentPath: null,
            currentQuestion: 0,
            answers: [],
            gameCompleted: false,
            typingSpeed: 30,
            skipTyping: false,
            currentCaseIndex: 0,
            currentEnding: null
        };

        // DOM elements
        const contentElement = document.getElementById('content');

        // Initialize the game
        function initGame() {
            showTitleScreen();
        }

        // Show title screen
        function showTitleScreen() {
            let html = `
                <div class="title-screen" style="background-image: url('${images.titleBackground}')">
                    <h1>RATING PENDING</h1>
                    <p>A Choose-Your-Own-Censorship Experience</p>
                    <button class="start-btn" onclick="showIntroScreen()">Begin Experience</button>
                </div>
            `;
            contentElement.innerHTML = html;
        }

        // Show intro screen
        function showIntroScreen() {
            let html = `
                <button class="skip-btn" onclick="skipTyping()">Skip</button>
                <div class="scene-image">
                    <img src="${images.startingPoint}" alt="Board Room">
                </div>
                <div class="story-text" id="story-text"></div>
                <button class="continue-btn" onclick="showPathSelection()" style="display: none;" id="continue-btn">Continue to Cases</button>
            `;
            contentElement.innerHTML = html;
            
            const text = "You are a board member of MTRCB. Today's another normal day at work, back in the board room with three film cases to review. You take a look around the other board members with you: The Bureaucrat, the Conservative, and the Progressive. You take a sip of coffee. Which case file should we start with today?";
            typeText(text, document.getElementById('story-text'), () => {
                document.getElementById('continue-btn').style.display = 'block';
            });
        }

        // Show path selection screen
        function showPathSelection() {
            const pathKeys = Object.keys(storyData.paths);
            
            let html = `
                <div class="desk-interface">
                    <div class="story-text">
                        <h2>Case Files</h2>
                        <p>Select a case file to review. Your decisions will shape Philippine cinema.</p>
                    </div>
                    <div class="case-carousel">
                        <div class="carousel-container">
                            ${pathKeys.map((key, index) => {
                                const path = storyData.paths[key];
                                const thumbnailPath = getImagePath(key + '.thumbnail');
                                let positionClass = '';
                                
                                if (index === gameState.currentCaseIndex) {
                                    positionClass = 'active';
                                } else if (index === (gameState.currentCaseIndex - 1 + pathKeys.length) % pathKeys.length) {
                                    positionClass = 'left';
                                } else if (index === (gameState.currentCaseIndex + 1) % pathKeys.length) {
                                    positionClass = 'right';
                                } else if (index === (gameState.currentCaseIndex - 2 + pathKeys.length) % pathKeys.length) {
                                    positionClass = 'hidden-left';
                                } else {
                                    positionClass = 'hidden-right';
                                }
                                
                                let clickHandler = '';
                                if (positionClass === 'active') {
                                    clickHandler = `selectPath('${key}')`;
                                } else if (positionClass === 'left') {
                                    clickHandler = `previousCase()`;
                                } else if (positionClass === 'right') {
                                    clickHandler = `nextCase()`;
                                } else {
                                    clickHandler = 'void(0)';
                                }
                                
                                return `
                                    <div class="folder ${positionClass}" onclick="${clickHandler}">
                                        <img src="${thumbnailPath}" alt="${path.title}" class="folder-image">
                                        <div class="folder-content">
                                            <h3>${path.title}</h3>
                                            <p>${path.description}</p>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                        <div class="case-indicators">
                            ${pathKeys.map((key, index) => 
                                `<div class="indicator ${index === gameState.currentCaseIndex ? 'active' : ''}" onclick="goToCase(${index})"></div>`
                            ).join('')}
                        </div>
                    </div>
                </div>
            `;
            contentElement.innerHTML = html;
        }

        // Navigate to previous case
        function previousCase() {
            const pathKeys = Object.keys(storyData.paths);
            gameState.currentCaseIndex = (gameState.currentCaseIndex - 1 + pathKeys.length) % pathKeys.length;
            showPathSelection();
        }

        // Navigate to next case
        function nextCase() {
            const pathKeys = Object.keys(storyData.paths);
            gameState.currentCaseIndex = (gameState.currentCaseIndex + 1) % pathKeys.length;
            showPathSelection();
        }

        // Go to specific case
        function goToCase(index) {
            gameState.currentCaseIndex = index;
            showPathSelection();
        }

        // Select a path and start the story
        function selectPath(pathKey) {
            gameState.currentPath = pathKey;
            gameState.currentQuestion = 0;
            gameState.answers = [];
            gameState.skipTyping = false;
            showQuestion();
        }

        // Show the current question
        function showQuestion() {
            const path = storyData.paths[gameState.currentPath];
            const question = path.questions[gameState.currentQuestion];
            const choices = path.choices[gameState.currentQuestion];
            
            // Get image path
            const imagePath = getImagePath(question.image);
            
            let html = `
                <button class="skip-btn" onclick="skipTyping()">Skip</button>
                <div class="scene-image">
                    <img src="${imagePath}" alt="${path.title}">
                </div>
                <div class="story-text" id="story-text"></div>
                <div class="choices" id="choices-container" style="display: none;">
            `;
            
            choices.forEach((choice, index) => {
                html += `
                    <button class="choice-btn" onclick="selectAnswer('${choice.value}')">
                        ${choice.text}
                    </button>
                `;
            });
            
            html += `</div>`;
            contentElement.innerHTML = html;
            
            // Type the text
            typeText(question.text, document.getElementById('story-text'), () => {
                document.getElementById('choices-container').style.display = 'flex';
            });
        }

        // Select an answer and proceed to next question or ending
        function selectAnswer(value) {
            gameState.answers.push(value);
            
            const path = storyData.paths[gameState.currentPath];
            
            if (gameState.currentQuestion < path.questions.length - 1) {
                // More questions to go
                gameState.currentQuestion++;
                gameState.skipTyping = false;
                showQuestion();
            } else {
                // All questions answered, show ending
                showEnding();
            }
        }

        // Show the ending based on answers
        function showEnding() {
            const path = storyData.paths[gameState.currentPath];
            
            // Calculate which ending based on answer distribution
            const answerCounts = { A: 0, B: 0, C: 0 };
            gameState.answers.forEach(answer => {
                answerCounts[answer]++;
            });
            
            // Determine the most common answer
            let maxCount = 0;
            let endingKey = 'A';
            
            for (const key in answerCounts) {
                if (answerCounts[key] > maxCount) {
                    maxCount = answerCounts[key];
                    endingKey = key;
                }
            }
            
            const ending = path.endings[endingKey];
            gameState.currentEnding = ending;
            const imagePath = getImagePath(ending.image);
            
            let html = `
                <div class="scene-image">
                    <img src="${imagePath}" alt="${ending.title}">
                </div>
                <div class="ending-screen">
                    <div class="ending-title">${ending.title}</div>
                    <div class="ending-description">${ending.description}</div>
                    <div class="consequences">
                        <h3>Consequences:</h3>
                        <p>${ending.consequences}</p>
                    </div>
                    <button class="next-btn" onclick="showEndingReflection()">Continue</button>
                </div>
            `;
            
            contentElement.innerHTML = html;
            gameState.gameCompleted = true;
        }

        // Show ending reflection
        function showEndingReflection() {
            const ending = gameState.currentEnding;
            
            let html = `
                <div class="ending-reflection-screen">
                    <h2>Ending Reflection</h2>
                    <div class="ending-reflection">
                        <p>${ending.reflection}</p>
                    </div>
                    <button class="next-btn" onclick="showTheoreticalMessage()">Continue</button>
                </div>
            `;
            contentElement.innerHTML = html;
        }

        // Type text animation
        function typeText(text, element, callback) {
            element.innerHTML = '';
            gameState.skipTyping = false;
            
            let i = 0;
            const timer = setInterval(() => {
                if (gameState.skipTyping) {
                    element.innerHTML = text;
                    clearInterval(timer);
                    if (callback) callback();
                    return;
                }
                
                if (i < text.length) {
                    element.innerHTML += text.charAt(i);
                    i++;
                } else {
                    clearInterval(timer);
                    if (callback) callback();
                }
            }, gameState.typingSpeed);
        }

        // Skip typing animation
        function skipTyping() {
            gameState.skipTyping = true;
        }

        // Get image path from nested object
        function getImagePath(path) {
            const keys = path.split('.');
            let result = images;
            for (const key of keys) {
                result = result[key];
            }
            return result;
        }

        // Show theoretical message
        function showTheoreticalMessage() {
            let html = `
                <div class="theoretical-screen">
                    <h2>Theoretical Reflection</h2>
                    <p>This experience was guided by the principles of Ideological State Apparatuses (Althusser), where institutions reinforce dominant ideologies through cultural forms.</p>
                    <p>The MTRCB, as portrayed here, does not merely "classify" films. It classifies people, stories, and desires.</p>
                    <button class="next-btn" onclick="showCredits()">Continue</button>
                </div>
            `;
            contentElement.innerHTML = html;
        }

        // Show credits
        function showCredits() {
            let html = `
                <div class="credits-screen">
                    <h2>Credits</h2>
                    <p>Created for COMM 10: Introduction to Communication</p>
                    <p>University of the Philippines</p>
                    <p>Inspired by real cases of film classification in the Philippines</p>
                    <p>To learn more, scan this QR code for our Concept Paper:</p>
                    <div class="qr-code">
                        <img src="${images.qrCode}" alt="QR Code">
                    </div>
                    <p>"Choose Your Own Censorship: Tensions Between Conservatism and Progressivism in Filipino Media"</p>
                    <p>Abellanosa, Ally R.<br>Jacinto, Ingrid Dorothy DP.<br>Ladanan, Tyrone Jikaine T.<br>Rebanal, Cristina Andrea H.<br>Rosales, Elijah Kesh C.</p>
                    <p>Department of Humanities, University of the Philippines Los Baños<br>COMM 10: Critical Perspectives in Communication<br>Asst. Prof. Carson Jeffrey O. Cruz</p>
                    <p>All opinions expressed are purely fictional and do not represent any real government body.</p>
                    <button class="next-btn" onclick="showFinalMessage()">Continue</button>
                </div>
            `;
            contentElement.innerHTML = html;
        }

        // Show final message
        function showFinalMessage() {
            let html = `
                <div class="final-message-screen">
                    <h2>Please do not rate this experience.</h2>
                    <p>We already know what you'll choose.</p>
                    <button class="restart-btn" onclick="restartGame()">Play Again</button>
                </div>
            `;
            contentElement.innerHTML = html;
        }

        // Restart the game
        function restartGame() {
            gameState = {
                currentPath: null,
                currentQuestion: 0,
                answers: [],
                gameCompleted: false,
                typingSpeed: 30,
                skipTyping: false,
                currentCaseIndex: 0,
                currentEnding: null
            };
            initGame();
        }

        // Initialize the game when page loads
        window.onload = initGame;
    </script>
</body>
</html>
